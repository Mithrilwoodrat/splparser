
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse('where DistinctLogCount>=2 AND Distinctuser>=2 AND TotalAttempt>400').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'AND')
                ('FUNCTION': 'ge')
                    ('FIELD': 'DistinctLogCount')
                    ('VALUE': '2')
                ('FUNCTION': 'ge')
                    ('FIELD': 'Distinctuser')
                    ('VALUE': '2')
                ('FUNCTION': 'gt')
                    ('FIELD': 'TotalAttempt')
                    ('VALUE': '400')

>>> splparser.parse('where end_time=maxlastrepORted AND isnull(lastrepORted_itam)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'AND')
                ('FUNCTION': 'eq')
                    ('FIELD': 'end_time')
                    ('FIELD': 'maxlastrepORted')
                ('FUNCTION': 'isnull')
                    ('FIELD': 'lastrepORted_itam')

>>> splparser.parse('where LastMessageTime=LastDetected AND (UptoDate="Unknown" OR NOT PathAndName LIKE "GISALGAVEC03\money\emea\uk_hl\%" OR NOT SavVersion LIKE "9.5%")').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'AND')
                ('FUNCTION': 'eq')
                    ('FIELD': 'LastMessageTime')
                    ('FIELD': 'LastDetected')
                ('FUNCTION': 'OR')
                    ('FUNCTION': 'eq')
                        ('FIELD': 'UptoDate')
                        ('VALUE': '"Unknown"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'LIKE')
                            ('FIELD': 'PathAndName')
                            ('VALUE': '"GISALGAVEC03\money\emea\uk_hl\%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'LIKE')
                            ('FIELD': 'SavVersion')
                            ('VALUE': '"9.5%"')

>>> splparser.parse('where (m_EMAILCOUNT > 2000) AND (m_EMAILCOUNT < 11000)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'AND')
                ('FUNCTION': 'gt')
                    ('FIELD': 'm_EMAILCOUNT')
                    ('VALUE': '2000')
                ('FUNCTION': 'lt')
                    ('FIELD': 'm_EMAILCOUNT')
                    ('VALUE': '11000')

>>> splparser.parse('where "Total C2S Bytes" > 50000000').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'gt')
                ('FIELD': '"Total C2S Bytes"')
                ('VALUE': '50000000')

>>> splparser.parse('where isnull(nullif(host,host_name))').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'isnull')
                ('FUNCTION': 'nullif')
                    ('FIELD': 'host')
                    ('FIELD': 'host_name')

>>> splparser.parse('where count > 1000').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'gt')
                ('FIELD': 'count')
                ('VALUE': '1000')

>>> splparser.parse('where cidrmatch("216.113.11.128/27",TVT_IP) OR cidrmatch("216.113.15.128/27",TVT_IP)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'OR')
                ('FUNCTION': 'cidrmatch')
                    ('VALUE': '"216.113.11.128/27"')
                    ('FIELD': 'TVT_IP')
                ('FUNCTION': 'cidrmatch')
                    ('VALUE': '"216.113.15.128/27"')
                    ('FIELD': 'TVT_IP')

>>> splparser.parse('where ( LLTS > relative_time(now(), "-14d@d") )').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'gt')
                ('FIELD': 'LLTS')
                ('FUNCTION': 'relative_time')
                    ('FUNCTION': 'now')
                    ('VALUE': '"-14d@d"')

>>> splparser.parse('where distance/time > 100').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'gt')
                ('FUNCTION': 'divides')
                    ('FIELD': 'distance')
                    ('FIELD': 'time')
                ('VALUE': '100')

>>> splparser.parse('where like(src, "10.9.165.%") OR cidrmatch("10.9.165.0/25", dst)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'OR')
                ('FUNCTION': 'like')
                    ('FIELD': 'src')
                    ('VALUE': '"10.9.165.%"')
                ('FUNCTION': 'cidrmatch')
                    ('VALUE': '"10.9.165.0/25"')
                    ('FIELD': 'dst')

>>> splparser.parse('where (internalPage != "login.mob" AND internalPage != "homepage.mob" AND NOT like(internalPage,"challenge%") AND NOT like(internalPage,"deactivate%") AND NOT like(internalPage,"otp%") AND NOT like(internalPage,"jsf%") AND NOT like(internalPage,"acctprefcontext%") AND NOT like(internalPage, "payment%") AND NOT like(internalPage, "ajax%") AND NOT like(internalPage, "irrdrill%") AND NOT like(internalPage,"irrpref%") AND NOT like(internalPage,"irrsearch%") AND NOT like(internalPage,"irrcontext%")) OR like(internalPage,"irrsummary%") OR like(internalPage, "irrbalance%") OR internalPage == "deactivateuser.mob" OR internalPage == "paymentreview.mob" OR internalPage == "paymentdetails.mob"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'OR')
                ('FUNCTION': 'AND')
                    ('FUNCTION': 'ne')
                        ('FIELD': 'internalPage')
                        ('VALUE': '"login.mob"')
                    ('FUNCTION': 'ne')
                        ('FIELD': 'internalPage')
                        ('VALUE': '"homepage.mob"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"challenge%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"deactivate%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"otp%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"jsf%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"acctprefcontext%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"payment%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"ajax%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"irrdrill%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"irrpref%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"irrsearch%"')
                    ('FUNCTION': 'NOT')
                        ('FUNCTION': 'like')
                            ('FIELD': 'internalPage')
                            ('VALUE': '"irrcontext%"')
                ('FUNCTION': 'like')
                    ('FIELD': 'internalPage')
                    ('VALUE': '"irrsummary%"')
                ('FUNCTION': 'like')
                    ('FIELD': 'internalPage')
                    ('VALUE': '"irrbalance%"')
                ('FUNCTION': 'deq')
                    ('FIELD': 'internalPage')
                    ('VALUE': '"deactivateuser.mob"')
                ('FUNCTION': 'deq')
                    ('FIELD': 'internalPage')
                    ('VALUE': '"paymentreview.mob"')
                ('FUNCTION': 'deq')
                    ('FIELD': 'internalPage')
                    ('VALUE': '"paymentdetails.mob"')

>>> splparser.parse('where NOT tmp=Pay_Address').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'NOT')
                ('FUNCTION': 'eq')
                    ('FIELD': 'tmp')
                    ('FIELD': 'Pay_Address')

>>> splparser.parse('where Y_time!=C_time').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'ne')
                ('FIELD': 'Y_time')
                ('FIELD': 'C_time')

>>> splparser.parse('where indexer_ratio*avg_bytes_last_week < 0.5*avg_bytes_today').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'lt')
                ('FUNCTION': 'times')
                    ('FIELD': 'indexer_ratio')
                    ('FIELD': 'avg_bytes_last_week')
                ('FUNCTION': 'times')
                    ('VALUE': '0.5')
                    ('FIELD': 'avg_bytes_today')

>>> splparser.parse('where _indextime > now()-86400').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'where')
            ('FUNCTION': 'gt')
                ('FIELD': '_indextime')
                ('FUNCTION': 'minus')
                    ('FUNCTION': 'now')
                    ('VALUE': '86400')
