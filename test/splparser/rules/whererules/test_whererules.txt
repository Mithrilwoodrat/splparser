
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse('where DistinctLogCount>=2 AND Distinctuser>=2 AND TotalAttempt>400').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('AND')
                ('GE')
                    ('WORD': 'DistinctLogCount')
                    ('INT': '2')
                ('GE')
                    ('WORD': 'Distinctuser')
                    ('INT': '2')
                ('GT')
                    ('WORD': 'TotalAttempt')
                    ('INT': '400')

>>> splparser.parse('where end_time=maxlastreported AND isnull(lastreported_itam)').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('AND')
                ('EQ')
                    ('ID': 'end_time')
                    ('WORD': 'maxlastreported')
                ('ISNULL')
                    ('ID': 'lastreported_itam')

>>> splparser.parse('where LastMessageTime=LastDetected AND (UptoDate="Unknown" OR NOT PathAndName LIKE "GISALGAVEC03\money\emea\uk_hl\%" OR NOT SavVersion LIKE "9.5%")').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('AND')
                ('EQ')
                    ('WORD': 'LastMessageTime')
                    ('WORD': 'LastDetected')
                ('OR')
                    ('EQ')
                        ('WORD': 'UptoDate')
                        ('WORD': '"Unknown"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'PathAndName')
                            ('LITERAL': '"GISALGAVEC03\money\emea\uk_hl\%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'SavVersion')
                            ('NBSTR': '"9.5%"')

>>> splparser.parse('where (m_EMAILCOUNT > 2000) AND (m_EMAILCOUNT < 11000)').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('AND')
                ('GT')
                    ('ID': 'm_EMAILCOUNT')
                    ('INT': '2000')
                ('LT')
                    ('ID': 'm_EMAILCOUNT')
                    ('INT': '11000')

>>> splparser.parse('where "Total C2S Bytes" > 50000000').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('GT')
                ('LITERAL': '"Total C2S Bytes"')
                ('INT': '50000000')

>>> splparser.parse('where isnull(nullif(host,host_name))').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('ISNULL')
                ('NULLIF')
                    ('WORD': 'host')
                    ('ID': 'host_name')

>>> splparser.parse('where count > 1000').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('GT')
                ('WORD': 'count')
                ('INT': '1000')

>>> splparser.parse('where cidrmatch("216.113.11.128/27",TVT_IP) OR cidrmatch("216.113.15.128/27",TVT_IP)').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('OR')
                ('CIDRMATCH')
                    ('IPV4ADDR': '"216.113.11.128/27"')
                    ('ID': 'TVT_IP')
                ('CIDRMATCH')
                    ('IPV4ADDR': '"216.113.15.128/27"')
                    ('ID': 'TVT_IP')

>>> splparser.parse('where ( LLTS > relative_time(now(), "-14d@d") )').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('GT')
                ('WORD': 'LLTS')
                ('RELATIVE_TIME')
                    ('NOW')
                    ('NBSTR': '"-14d@d"')

>>> splparser.parse('where distance/time > 100').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('GT')
                ('DIVIDES')
                    ('WORD': 'distance')
                    ('WORD': 'time')
                ('INT': '100')

>>> splparser.parse('where like(src, "10.9.165.%") OR cidrmatch("10.9.165.0/25", dst)').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('OR')
                ('LIKE')
                    ('WORD': 'src')
                    ('NBSTR': '"10.9.165.%"')
                ('CIDRMATCH')
                    ('IPV4ADDR': '"10.9.165.0/25"')
                    ('WORD': 'dst')

>>> splparser.parse('where (internalPage != "login.mob" AND internalPage != "homepage.mob" AND NOT like(internalPage,"challenge%") AND NOT like(internalPage,"deactivate%") AND NOT like(internalPage,"otp%") AND NOT like(internalPage,"jsf%") AND NOT like(internalPage,"acctprefcontext%") AND NOT like(internalPage, "payment%") AND NOT like(internalPage, "ajax%") AND NOT like(internalPage, "irrdrill%") AND NOT like(internalPage,"irrpref%") AND NOT like(internalPage,"irrsearch%") AND NOT like(internalPage,"irrcontext%")) OR like(internalPage,"irrsummary%") OR like(internalPage, "irrbalance%") OR internalPage == "deactivateuser.mob" OR internalPage == "paymentreview.mob" OR internalPage == "paymentdetails.mob"').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('OR')
                ('AND')
                    ('NE')
                        ('WORD': 'internalPage')
                        ('NBSTR': '"login.mob"')
                    ('NE')
                        ('WORD': 'internalPage')
                        ('NBSTR': '"homepage.mob"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"challenge%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"deactivate%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"otp%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"jsf%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"acctprefcontext%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"payment%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"ajax%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"irrdrill%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"irrpref%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"irrsearch%"')
                    ('NOT')
                        ('LIKE')
                            ('WORD': 'internalPage')
                            ('NBSTR': '"irrcontext%"')
                ('LIKE')
                    ('WORD': 'internalPage')
                    ('NBSTR': '"irrsummary%"')
                ('LIKE')
                    ('WORD': 'internalPage')
                    ('NBSTR': '"irrbalance%"')
                ('DEQ')
                    ('WORD': 'internalPage')
                    ('NBSTR': '"deactivateuser.mob"')
                ('DEQ')
                    ('WORD': 'internalPage')
                    ('NBSTR': '"paymentreview.mob"')
                ('DEQ')
                    ('WORD': 'internalPage')
                    ('NBSTR': '"paymentdetails.mob"')

>>> splparser.parse('where NOT tmp=Pay_Address').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('NOT')
                ('EQ')
                    ('WORD': 'tmp')
                    ('ID': 'Pay_Address')

>>> splparser.parse('where Y_time!=C_time').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('NE')
                ('ID': 'Y_time')
                ('ID': 'C_time')

>>> splparser.parse('where indexer_ratio*avg_bytes_last_week < 0.5*avg_bytes_today').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('LT')
                ('TIMES')
                    ('ID': 'indexer_ratio')
                    ('ID': 'avg_bytes_last_week')
                ('TIMES')
                    ('FLOAT': '0.5')
                    ('ID': 'avg_bytes_today')

>>> splparser.parse('where _indextime > now()-86400').print_tree()
('ROOT')
    ('STAGE')
        ('WHERE')
            ('GT')
                ('ID': '_indextime')
                ('MINUS')
                    ('NOW')
                    ('INT': '86400')
