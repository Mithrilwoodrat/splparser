
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse("search foo | search bat | search blah | stats count").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'search')
            ('FUNCTION': 'contains')
                ('VALUE': 'foo')
    ('STAGE')
        ('COMMAND': 'search')
            ('FUNCTION': 'contains')
                ('VALUE': 'bat')
    ('STAGE')
        ('COMMAND': 'search')
            ('FUNCTION': 'contains')
                ('VALUE': 'blah')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'count')

>>> splparser.parse("stats count, count").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'count')
            ('FUNCTION': 'count')

>>> splparser.parse("stats count a").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'count')
                ('FIELD': 'a')

>>> splparser.parse("stats count a, count b").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'count')
                ('FIELD': 'a')
            ('FUNCTION': 'count')
                ('FIELD': 'b')

>>> splparser.parse("stats count(f)").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'count')
                ('FIELD': 'f')

>>> splparser.parse("stats count(f) as cf").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'as')
                ('FUNCTION': 'count')
                    ('FIELD': 'f')
                ('FIELD': 'cf')

>>> splparser.parse("stats count(f) by b").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'count')
                    ('FIELD': 'f')
                ('GROUPING_FIELD': 'b')

>>> splparser.parse("stats count(f) by b, d").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'count')
                    ('FIELD': 'f')
                ('GROUPING_FIELD': 'b')
                ('GROUPING_FIELD': 'd')

>>> splparser.parse("stats count(f) as a by b, d").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'as')
                    ('FUNCTION': 'count')
                        ('FIELD': 'f')
                    ('FIELD': 'a')
                ('GROUPING_FIELD': 'b')
                ('GROUPING_FIELD': 'd')

>>> splparser.parse('search sourcetype=access_* | stats eval(method="GET") AS GET').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'search')
            ('FUNCTION': 'eq')
                ('DEFAULT_FIELD': 'sourcetype')
                ('VALUE': 'access_*')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'as')
                ('FUNCTION': 'eval')
                    ('FUNCTION': 'eq')
                        ('FIELD': 'method')
                        ('VALUE': '"GET"')
                ('FIELD': 'GET')

>>> splparser.parse('search sourcetype=access_* | stats count(eval(method="GET")) AS GET').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'search')
            ('FUNCTION': 'eq')
                ('DEFAULT_FIELD': 'sourcetype')
                ('VALUE': 'access_*')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'as')
                ('FUNCTION': 'count')
                    ('FUNCTION': 'eval')
                        ('FUNCTION': 'eq')
                            ('FIELD': 'method')
                            ('VALUE': '"GET"')
                ('FIELD': 'GET')

>>> splparser.parse('search sourcetype=access_* | stats count(eval(method="GET")) AS GET, count(eval(method="POST")) AS POST by host').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'search')
            ('FUNCTION': 'eq')
                ('DEFAULT_FIELD': 'sourcetype')
                ('VALUE': 'access_*')
    ('STAGE')
        ('COMMAND': 'stats')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'as')
                    ('FUNCTION': 'count')
                        ('FUNCTION': 'eval')
                            ('FUNCTION': 'eq')
                                ('FIELD': 'method')
                                ('VALUE': '"GET"')
                    ('FIELD': 'GET')
                ('FUNCTION': 'as')
                    ('FUNCTION': 'count')
                        ('FUNCTION': 'eval')
                            ('FUNCTION': 'eq')
                                ('FIELD': 'method')
                                ('VALUE': '"POST"')
                    ('FIELD': 'POST')
                ('GROUPING_DEFAULT_FIELD': 'host')
