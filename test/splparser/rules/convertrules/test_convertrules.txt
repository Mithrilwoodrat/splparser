
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse('convert timeformat="%H:%M:%S" ctime(_time) AS c_time').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('EQ': 'assign')
                ('OPTION': 'timeformat')
                ('VALUE': '"%H:%M:%S"')
            ('FUNCTION': 'as')
                ('FUNCTION': 'ctime')
                    ('INTERNAL_FIELD': '_time')
                ('FIELD': 'c_time')

>>> splparser.parse('convert mstime(_time) AS ms_time').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('FUNCTION': 'as')
                ('FUNCTION': 'mstime')
                    ('INTERNAL_FIELD': '_time')
                ('FIELD': 'ms_time')

>>> splparser.parse('convert rmunit(duration)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('FUNCTION': 'rmunit')
                ('FIELD': 'duration')

>>> splparser.parse('convert dur2sec(delay)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('FUNCTION': 'dur2sec')
                ('FIELD': 'delay')

>>> splparser.parse('convert memk(virt)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('FUNCTION': 'memk')
                ('FIELD': 'virt')

>>> splparser.parse('convert auto(*) none(foo)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('FUNCTION': 'auto')
                ('FIELD': '*')
            ('FUNCTION': 'none')
                ('FIELD': 'foo')

>>> splparser.parse('convert dur2sec(xdelay) dur2sec(delay)').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('FUNCTION': 'dur2sec')
                ('FIELD': 'xdelay')
            ('FUNCTION': 'dur2sec')
                ('FIELD': 'delay')

>>> splparser.parse('convert ctime(_time) AS "Deleted On"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('FUNCTION': 'as')
                ('FUNCTION': 'ctime')
                    ('INTERNAL_FIELD': '_time')
                ('FIELD': '"Deleted On"')

>>> splparser.parse('convert timeformat="%Y-%m-%d" ctime("Last Reported Safeboot") ctime("Last Checked In") ctime(lastreported_itam) ctime("Last Reported ITAM") ctime("Last Reported EPE") ctime("Last Reported Qualys") ctime("Last Reported Sophos") ctime("Last Reported WSUS")').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'convert')
            ('EQ': 'assign')
                ('OPTION': 'timeformat')
                ('VALUE': '"%Y-%m-%d"')
            ('FUNCTION': 'ctime')
                ('FIELD': '"Last Reported Safeboot"')
            ('FUNCTION': 'ctime')
                ('FIELD': '"Last Checked In"')
            ('FUNCTION': 'ctime')
                ('FIELD': 'lastreported_itam')
            ('FUNCTION': 'ctime')
                ('FIELD': '"Last Reported ITAM"')
            ('FUNCTION': 'ctime')
                ('FIELD': '"Last Reported EPE"')
            ('FUNCTION': 'ctime')
                ('FIELD': '"Last Reported Qualys"')
            ('FUNCTION': 'ctime')
                ('FIELD': '"Last Reported Sophos"')
            ('FUNCTION': 'ctime')
                ('FIELD': '"Last Reported WSUS"')

TODO: These appeared in the logs but I don't think they're legal:
splparser.parse('convert ctime(runId/1000)').print_tree()
splparser.parse('convert tsearch daysage<31').print_tree()
