
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse('streamstats dc(ips) as "Cumulative total"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'streamstats')
            ('FUNCTION': 'as')
                ('FUNCTION': 'distinct_count')
                    ('FIELD': 'ips')
                ('FIELD': '"Cumulative total"')

>>> splparser.parse("streamstats global=f sum(total) as accu_total").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'streamstats')
            ('EQ': 'assign')
                ('OPTION': 'global')
                ('VALUE': 'f')
            ('FUNCTION': 'as')
                ('FUNCTION': 'sum')
                    ('FIELD': 'total')
                ('FIELD': 'accu_total')

>>> splparser.parse("streamstats current=f last(DHCP_IP) as new_dhcp_ip last(_time) as time_of_change by MAC").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'streamstats')
            ('EQ': 'assign')
                ('OPTION': 'current')
                ('VALUE': 'f')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'as')
                    ('FUNCTION': 'last')
                        ('FIELD': 'DHCP_IP')
                    ('FIELD': 'new_dhcp_ip')
                ('FUNCTION': 'as')
                    ('FUNCTION': 'last')
                        ('INTERNAL_FIELD': '_time')
                    ('FIELD': 'time_of_change')
                ('GROUPING_FIELD': 'MAC')

>>> splparser.parse("streamstats count").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'streamstats')
            ('FUNCTION': 'count')

>>> splparser.parse("streamstats avg(foo) by bar window=5 global=f").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'streamstats')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'mean')
                    ('FIELD': 'foo')
                ('GROUPING_FIELD': 'bar')
            ('EQ': 'assign')
                ('OPTION': 'window')
                ('VALUE': '5')
            ('EQ': 'assign')
                ('OPTION': 'global')
                ('VALUE': 'f')

>>> splparser.parse("streamstats avg(foo) window=5").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'streamstats')
            ('FUNCTION': 'mean')
                ('FIELD': 'foo')
            ('EQ': 'assign')
                ('OPTION': 'window')
                ('VALUE': '5')

>>> splparser.parse("streamstats count current=f").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'streamstats')
            ('FUNCTION': 'count')
            ('EQ': 'assign')
                ('OPTION': 'current')
                ('VALUE': 'f')
