
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser

>>> splparser.parse('rex field=_raw "From: (?<from>.*) To: (?<to>.*)"').print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('FIELD')
                ('ID': '_raw')
            ('REGULAR_EXPRESSION': '"From: (?<from>.*) To: (?<to>.*)"')

>>> splparser.parse('rex field=savedsearch_id "(?<user>\w+);(?<app>\w+);(?<SavedSearchName>\w+)"').print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('FIELD')
                ('ID': 'savedsearch_id')
            ('REGULAR_EXPRESSION': '"(?<user>\w+);(?<app>\w+);(?<SavedSearchName>\w+)"')

>>> splparser.parse('rex field=Host mode=sed "s/(\\d{4}-){3}/XXXX-XXXX-XXXX-/g"').print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('FIELD')
                ('WORD': 'Host')
            ('EQ')
                ('MODE')
                ('WORD': 'sed')
            ('REGULAR_EXPRESSION': '"s/(\d{4}-){3}/XXXX-XXXX-XXXX-/g"')

>>> splparser.parse('rex field=Host "^(?<Host>[a-z][^\.]+)"').print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('FIELD')
                ('WORD': 'Host')
            ('REGULAR_EXPRESSION': '"^(?<Host>[a-z][^\.]+)"')

>>> splparser.parse('rex "(?<url>http.*)"').print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('REGULAR_EXPRESSION': '"(?<url>http.*)"')

>>> splparser.parse('rex field=source ".*\.(?<myhost>.*)-sfm.*" splunk-search').print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('FIELD')
                ('WORD': 'source')
            ('REGULAR_EXPRESSION': '".*\.(?<myhost>.*)-sfm.*"')
            ('ID': 'splunk-search')

>>> splparser.parse('rex field=_raw "^(?<source_ip>[0-9]*\.[0-9]*\.[0-9]*\.[0-9]*)[^]]*\] \"(?<action>[A-Z]*) (?<uri>[A-Za-z/\.]*) (?<Protocol>[^\"]*)\" (?<response>[0-9]*) (?<bytes>[0-9\-]*)"').print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('FIELD')
                ('ID': '_raw')
            ('REGULAR_EXPRESSION': '"^(?<source_ip>[0-9]*\.[0-9]*\.[0-9]*\.[0-9]*)[^]]*\] " (?<action>[A-Z]*) (?<uri>[A-Za-z/\.]*) (?<Protocol>[^ "]*)" (?<response>[0-9]*) (?<bytes>[0-9\-]*) "')