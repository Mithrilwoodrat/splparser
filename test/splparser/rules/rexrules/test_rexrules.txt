
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser

>>> splparser.parse('rex field=_raw "From: (?<from>.*) To: (?<to>.*)"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'rex')
            ('EQ': 'assign')
                ('OPTION': 'field')
                ('FIELD': '_raw')
            ('VALUE': '"From: (?<from>.*) To: (?<to>.*)"')

>>> splparser.parse('rex field=savedsearch_id "(?<user>\w+);(?<app>\w+);(?<SavedSearchName>\w+)"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'rex')
            ('EQ': 'assign')
                ('OPTION': 'field')
                ('FIELD': 'savedsearch_id')
            ('VALUE': '"(?<user>\w+);(?<app>\w+);(?<SavedSearchName>\w+)"')

>>> splparser.parse('rex field=Host mode=sed "s/(\\d{4}-){3}/XXXX-XXXX-XXXX-/g"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'rex')
            ('EQ': 'assign')
                ('OPTION': 'field')
                ('FIELD': 'Host')
            ('EQ': 'assign')
                ('OPTION': 'mode')
                ('VALUE': 'sed')
            ('VALUE': '"s/(\d{4}-){3}/XXXX-XXXX-XXXX-/g"')

>>> splparser.parse('rex field=Host "^(?<Host>[a-z][^\.]+)"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'rex')
            ('EQ': 'assign')
                ('OPTION': 'field')
                ('FIELD': 'Host')
            ('VALUE': '"^(?<Host>[a-z][^\.]+)"')

>>> splparser.parse('rex "(?<url>http.*)"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'rex')
            ('VALUE': '"(?<url>http.*)"')

>>> splparser.parse('rex field=source ".*\.(?<myhost>.*)-sfm.*"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'rex')
            ('EQ': 'assign')
                ('OPTION': 'field')
                ('FIELD': 'source')
            ('VALUE': '".*\.(?<myhost>.*)-sfm.*"')

>>> splparser.parse('rex field=_raw "^(?<source_ip>[0-9]*\.[0-9]*\.[0-9]*\.[0-9]*)[^]]*\] \"(?<action>[A-Z]*) (?<uri>[A-Za-z/\.]*) (?<Protocol>[^\"]*)\" (?<response>[0-9]*) (?<bytes>[0-9\-]*)"').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'rex')
            ('EQ': 'assign')
                ('OPTION': 'field')
                ('FIELD': '_raw')
            ('VALUE': '"^(?<source_ip>[0-9]*\.[0-9]*\.[0-9]*\.[0-9]*)[^]]*\] " (?<action>[A-Z]*) (?<uri>[A-Za-z/\.]*) (?<Protocol>[^ "]*)" (?<response>[0-9]*) (?<bytes>[0-9\-]*) "')
