
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse("fields + category action http_user_agent filter_result src_ip dest_host uri uri_path http_method http_content_type uri_query _time").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'fields')
            ('PLUS')
                ('FIELD': 'category')
                ('FIELD': 'action')
                ('FIELD': 'http_user_agent')
                ('FIELD': 'filter_result')
                ('FIELD': 'src_ip')
                ('FIELD': 'dest_host')
                ('FIELD': 'uri')
                ('FIELD': 'uri_path')
                ('FIELD': 'http_method')
                ('FIELD': 'http_content_type')
                ('FIELD': 'uri_query')
                ('INTERNAL_FIELD': '_time')

>>> splparser.parse("fields IPAddress,action,HostName,user,FullFilePath,ThreatName").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'fields')
            ('PLUS')
                ('FIELD': 'IPAddress')
                ('FIELD': 'action')
                ('FIELD': 'HostName')
                ('FIELD': 'user')
                ('FIELD': 'FullFilePath')
                ('FIELD': 'ThreatName')

>>> splparser.parse("fields SSO dest_host IPaddress signature action severity cdi_city cdi_country FullFilePath").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'fields')
            ('PLUS')
                ('FIELD': 'SSO')
                ('FIELD': 'dest_host')
                ('FIELD': 'IPaddress')
                ('FIELD': 'signature')
                ('FIELD': 'action')
                ('FIELD': 'severity')
                ('FIELD': 'cdi_city')
                ('FIELD': 'cdi_country')
                ('FIELD': 'FullFilePath')

>>> splparser.parse("fields - sum").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'fields')
            ('MINUS')
                ('FIELD': 'sum')

>>> splparser.parse("fields - _raw,_cd,_indextime,_serial,_si,_sourcetype").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'fields')
            ('MINUS')
                ('INTERNAL_FIELD': '_raw')
                ('INTERNAL_FIELD': '_cd')
                ('INTERNAL_FIELD': '_indextime')
                ('FIELD': '_serial')
                ('FIELD': '_si')
                ('FIELD': '_sourcetype')

>>> splparser.parse("fields - countHost-_span countHost-_time lag-_span").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'fields')
            ('MINUS')
                ('FIELD': 'countHost-_span')
                ('FIELD': 'countHost-_time')
                ('FIELD': 'lag-_span')
