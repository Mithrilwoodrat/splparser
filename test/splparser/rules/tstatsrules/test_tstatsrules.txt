
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse("tstats count FROM mydata").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'tstats')
            ('FUNCTION': 'count')
            ('EQ': 'assign')
                ('OPTION': 'from')
                ('VALUE': 'mydata')

>>> splparser.parse("tstats avg(foo) FROM mydata WHERE bar=value2 baz>5").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'tstats')
            ('FUNCTION': 'mean')
                ('FIELD': 'foo')
            ('EQ': 'assign')
                ('OPTION': 'from')
                ('VALUE': 'mydata')
            ('FUNCTION': 'where')
                ('FUNCTION': 'AND')
                    ('FUNCTION': 'eq')
                        ('FIELD': 'bar')
                        ('VALUE': 'value2')
                    ('FUNCTION': 'gt')
                        ('FIELD': 'baz')
                        ('VALUE': '5')

>>> splparser.parse("tstats count where host=x by source").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'tstats')
            ('FUNCTION': 'where')
                ('FUNCTION': 'eq')
                    ('DEFAULT_FIELD': 'host')
                    ('VALUE': 'x')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'count')
                ('GROUPING_DEFAULT_FIELD': 'source')

>>> splparser.parse("tstats prestats=t count by _time span=1d").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'tstats')
            ('EQ': 'assign')
                ('OPTION': 'prestats')
                ('VALUE': 't')
            ('FUNCTION': 'groupby')
                ('FUNCTION': 'count')
                ('GROUPING_INTERNAL_FIELD': '_time')
            ('EQ': 'assign')
                ('OPTION': 'span')
                ('VALUE': '1d')

>>> splparser.parse("tstats prestats=t median(foo) from mydata ").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'tstats')
            ('EQ': 'assign')
                ('OPTION': 'prestats')
                ('VALUE': 't')
            ('FUNCTION': 'median')
                ('FIELD': 'foo')
            ('EQ': 'assign')
                ('OPTION': 'from')
                ('VALUE': 'mydata')

>>> splparser.parse("tstats prestats=t append=t median(bar) from otherdata").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'tstats')
            ('EQ': 'assign')
                ('OPTION': 'prestats')
                ('VALUE': 't')
            ('EQ': 'assign')
                ('OPTION': 'append')
                ('VALUE': 't')
            ('FUNCTION': 'median')
                ('FIELD': 'bar')
            ('EQ': 'assign')
                ('OPTION': 'from')
                ('VALUE': 'otherdata')
