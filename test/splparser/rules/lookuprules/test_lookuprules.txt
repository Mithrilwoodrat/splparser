
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parse("lookup sourcenames source").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'sourcenames')
            ('DEFAULT_FIELD': 'source')

>>> splparser.parse("lookup status_desc status OUTPUT description").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'status_desc')
            ('FIELD': 'status')
            ('OUTPUT')
                ('FIELD': 'description')

>>> splparser.parse("lookup local=true geoip clientip").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('EQ': 'assign')
                ('OPTION': 'local')
                ('VALUE': 'true')
            ('LOOKUP_TABLE': 'geoip')
            ('FIELD': 'clientip')

>>> splparser.parse("lookup usertogroup user as local_user OUTPUT group as user_group").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'usertogroup')
            ('FIELD': 'user')
                ('AS')
                    ('FIELD': 'local_user')
            ('OUTPUT')
                ('FIELD': 'group')
                    ('AS')
                        ('FIELD': 'user_group')

>>> splparser.parse("lookup update=true usertogroup user as local_user OUTPUT group as user_group").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('EQ': 'assign')
                ('OPTION': 'update')
                ('VALUE': 'true')
            ('LOOKUP_TABLE': 'usertogroup')
            ('FIELD': 'user')
                ('AS')
                    ('FIELD': 'local_user')
            ('OUTPUT')
                ('FIELD': 'group')
                    ('AS')
                        ('FIELD': 'user_group')

>>> splparser.parse("lookup swit 1 AS Snum OUTPUT Smod").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'swit')
            ('FIELD': '1')
                ('AS')
                    ('FIELD': 'Snum')
            ('OUTPUT')
                ('FIELD': 'Smod')

>>> splparser.parse("lookup log.csv profile was_host OUTPUT cell node").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'log.csv')
            ('FIELD': 'profile')
            ('FIELD': 'was_host')
            ('OUTPUT')
                ('FIELD': 'cell')
                ('FIELD': 'node')

>>> splparser.parse("lookup Service_Account_Lookup sAMAccountName as Account_Name OUTPUT sAMAccountName AS User_Account, AdminAccount").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'Service_Account_Lookup')
            ('FIELD': 'sAMAccountName')
                ('AS')
                    ('FIELD': 'Account_Name')
            ('OUTPUT')
                ('FIELD': 'sAMAccountName')
                    ('AS')
                        ('FIELD': 'User_Account')
                ('FIELD': 'AdminAccount')

>>> splparser.parse("lookup SecurityEventCode EventCode,LogName OUTPUTNEW desc").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'SecurityEventCode')
            ('FIELD': 'EventCode')
            ('FIELD': 'LogName')
            ('OUTPUTNEW')
                ('FIELD': 'desc')
