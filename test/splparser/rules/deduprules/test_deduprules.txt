>>> import splparser

>>> splparser.parse("dedup host").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('DEFAULT_FIELD': 'host')

>>> splparser.parse("dedup DMZ:192.168.11.44/2607").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('FIELD': 'DMZ:192.168.11.44/2607')


>>> splparser.parse("dedup test me").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('FIELD': 'test')
            ('FIELD': 'me')

>>> splparser.parse("dedup 100 host").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('EQ': 'assign')
                ('OPTION': 'n')
                ('VALUE': '100')
            ('DEFAULT_FIELD': 'host')

>>> splparser.parse("dedup clock sortby +_time").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('FIELD': 'clock')
            ('FUNCTION': 'sortby')
                ('FUNCTION': 'ascending')
                    ('INTERNAL_FIELD': '_time')

>>> splparser.parse("dedup HostName, signature, action sortby HostName").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('FIELD': 'HostName')
            ('FIELD': 'signature')
            ('FIELD': 'action')
            ('FUNCTION': 'sortby')
                ('FUNCTION': 'ascending')
                    ('FIELD': 'HostName')

>>> splparser.parse("dedup 1337 haxorz consecutive=true").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('EQ': 'assign')
                ('OPTION': 'n')
                ('VALUE': '1337')
            ('FIELD': 'haxorz')
            ('EQ': 'assign')
                ('OPTION': 'consecutive')
                ('VALUE': 'true')

>>> splparser.parse("dedup lol rofl lmao keepevents=true keepempty=true sortby -str(hilarity)").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('FIELD': 'lol')
            ('FIELD': 'rofl')
            ('FIELD': 'lmao')
            ('EQ': 'assign')
                ('OPTION': 'keepevents')
                ('VALUE': 'true')
            ('EQ': 'assign')
                ('OPTION': 'keepempty')
                ('VALUE': 'true')
            ('FUNCTION': 'sortby')
                ('FUNCTION': 'descending')
                    ('FUNCTION': 'str')
                        ('FIELD': 'hilarity')
        

>>> splparser.parse("dedup 9000 lol rofl lmao keepevents=true keepempty=true sortby -str(hilarity)").print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('EQ': 'assign')
                ('OPTION': 'n')
                ('VALUE': '9000')
            ('FIELD': 'lol')
            ('FIELD': 'rofl')
            ('FIELD': 'lmao')
            ('EQ': 'assign')
                ('OPTION': 'keepevents')
                ('VALUE': 'true')
            ('EQ': 'assign')
                ('OPTION': 'keepempty')
                ('VALUE': 'true')
            ('FUNCTION': 'sortby')
                ('FUNCTION': 'descending')
                    ('FUNCTION': 'str')
                        ('FIELD': 'hilarity')

>>> splparser.parse('search eventtype=msad-successful-computer-logons user="$" dest_nt_domain="EDM"|table _time,host,src_ip|dedup consecutive=T src_ip|lookup SiteInfo host|table _time,src_ip,Site').print_tree()
('ROOT')
    ('STAGE')
        ('COMMAND': 'search')
            ('FUNCTION': 'AND')
                ('FUNCTION': 'eq')
                    ('OPTION': 'eventtype')
                    ('VALUE': 'msad-successful-computer-logons')
                ('FUNCTION': 'eq')
                    ('FIELD': 'user')
                    ('VALUE': '"$"')
                ('FUNCTION': 'eq')
                    ('FIELD': 'dest_nt_domain')
                    ('VALUE': '"EDM"')
    ('STAGE')
        ('COMMAND': 'table')
            ('INTERNAL_FIELD': '_time')
            ('DEFAULT_FIELD': 'host')
            ('FIELD': 'src_ip')
    ('STAGE')
        ('COMMAND': 'dedup')
            ('EQ': 'assign')
                ('OPTION': 'consecutive')
                ('VALUE': 'T')
            ('FIELD': 'src_ip')
    ('STAGE')
        ('COMMAND': 'lookup')
            ('LOOKUP_TABLE': 'SiteInfo')
            ('DEFAULT_FIELD': 'host')
    ('STAGE')
        ('COMMAND': 'table')
            ('INTERNAL_FIELD': '_time')
            ('FIELD': 'src_ip')
            ('FIELD': 'Site')

