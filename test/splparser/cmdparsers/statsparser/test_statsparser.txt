
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> parsed = splparser.parser.parse("search foo | search bat | search blah | stats count")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('SEARCH')
            ('WORD': 'foo')
    ('STAGE')
        ('SEARCH')
            ('WORD': 'bat')
    ('STAGE')
        ('SEARCH')
            ('WORD': 'blah')
    ('STAGE')
        ('STATS')
            ('COUNT')

>>> parsed = splparser.parser.parse("stats count, count")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
            ('COUNT')

>>> parsed = splparser.parser.parse("stats count a")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('WORD': 'a')

>>> parsed = splparser.parser.parse("stats count a, count b")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('WORD': 'a')
            ('COUNT')
                ('WORD': 'b')

>>> parsed = splparser.parser.parse("stats count(f)")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('WORD': 'f')

>>> parsed = splparser.parser.parse("stats count(f) as cf")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('WORD': 'f')
                ('AS')
                    ('WORD': 'cf')

>>> parsed = splparser.parser.parse("stats count(f) by b")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('WORD': 'f')
                ('BY')
                    ('WORD': 'b')

>>> parsed = splparser.parser.parse("stats count(f) by b, d")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('WORD': 'f')
                ('BY')
                    ('WORD': 'b')
                    ('WORD': 'd')

>>> parsed = splparser.parser.parse("stats count(f) as a by b, d")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('WORD': 'f')
                ('AS')
                    ('WORD': 'a')
                ('BY')
                    ('WORD': 'b')
                    ('WORD': 'd')

>>> parsed = splparser.parser.parse('search sourcetype=access_* | stats eval(method="GET") AS GET')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('SEARCH')
            ('EQ')
                ('SOURCETYPE')
                ('ID': 'access_*')
    ('STAGE')
        ('STATS')
            ('EVAL')
                ('EQ')
                    ('WORD': 'method')
                    ('WORD': '"GET"')
                ('AS')
                    ('WORD': 'GET')

>>> parsed = splparser.parser.parse('search sourcetype=access_* | stats count(eval(method="GET")) AS GET')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('SEARCH')
            ('EQ')
                ('SOURCETYPE')
                ('ID': 'access_*')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('EVAL')
                    ('EQ')
                        ('WORD': 'method')
                        ('WORD': '"GET"')
                ('AS')
                    ('WORD': 'GET')

>>> parsed = splparser.parser.parse('search sourcetype=access_* | stats count(eval(method="GET")) AS GET, count(eval(method="POST")) AS POST by host')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('SEARCH')
            ('EQ')
                ('SOURCETYPE')
                ('ID': 'access_*')
    ('STAGE')
        ('STATS')
            ('COUNT')
                ('EVAL')
                    ('EQ')
                        ('WORD': 'method')
                        ('WORD': '"GET"')
                ('AS')
                    ('WORD': 'GET')
            ('COUNT')
                ('EVAL')
                    ('EQ')
                        ('WORD': 'method')
                        ('WORD': '"POST"')
                ('AS')
                    ('WORD': 'POST')
                ('BY')
                    ('WORD': 'host')
