
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> parsed = splparser.parser.parse('rex field=_raw "From: (?<from>.*) To: (?<to>.*)"')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('WORD': 'field')
                ('ID': '_raw')
            ('REGULAR_EXPRESSION': '"From: (?<from>.*) To: (?<to>.*)"')

>>> parsed = splparser.parser.parse('rex field=savedsearch_id "(?<user>\w+);(?<app>\w+);(?<SavedSearchName>\w+)"')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('WORD': 'field')
                ('WORD': 'savedsearch_id')
            ('REGULAR_EXPRESSION': '"(?<user>\w+);(?<app>\w+);(?<SavedSearchName>\w+)"')

>>> parsed = splparser.parser.parse('rex field=ccnumber mode=sed "s/(\\d{4}-){3}/XXXX-XXXX-XXXX-/g"')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('WORD': 'field')
                ('WORD': 'Host')
            ('EQ')
                ('WORD': 'mode')
                ('WORD': 'sed')
            ('REGULAR_EXPRESSION': '"s/(\\d{4}-){3}/XXXX-XXXX-XXXX-/g"')

>>> parsed = splparser.parser.parse('rex field=Host "^(?<Host>[a-z][^\.]+)"')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('WORD': 'field')
                ('WORD': 'Host')
            ('REGULAR_EXPRESSION': '"^(?<Host>[a-z][^\.]+)"')

>>> parsed = splparser.parser.parse('rex "(?<url>http.*)"')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('REGULAR_EXPRESSION': '"(?<url>http.*)"')

>>> parsed = splparser.parser.parse('rex field=source ".*\.(?<myhost>.*)-sfm.*" splunk-search')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('WORD': 'field')
                ('WORD': 'source')
            ('REGULAR_EXPRESSION': '".*\.(?<myhost>.*)-sfm.*"')
            ('REGULAR_EXPRESSION': 'splunk-search')

>>> parsed = splparser.parser.parse('rex field=_raw "^(?<source_ip>[0-9]*\.[0-9]*\.[0-9]*\.[0-9]*)[^]]*\] \"(?<action>[A-Z]*) (?<uri>[A-Za-z/\.]*) (?<Protocol>[^\"]*)\" (?<response>[0-9]*) (?<bytes>[0-9\-]*)"')
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('REX')
            ('EQ')
                ('WORD': 'field')
                ('ID': '_raw')
            ('REGULAR_EXPRESSION': '"^(?<source_ip>[0-9]*\.[0-9]*\.[0-9]*\.[0-9]*)[^]]*\] \"(?<action>[A-Z]*) (?<uri>[A-Za-z/\.]*) (?<Protocol>[^\"]*)\" (?<response>[0-9]*) (?<bytes>[0-9\-]*)"')
