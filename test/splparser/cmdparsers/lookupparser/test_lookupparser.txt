
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> splparser.parser.parse("lookup sourcenames source").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('WORD': 'sourcenames')
            ('WORD': 'source')

>>> splparser.parser.parse("lookup status_desc status OUTPUT description").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('ID': 'status_desc')
            ('WORD': 'status')
            ('OUTPUT')
                ('WORD': 'description')

>>> splparser.parser.parse("lookup local=true geoip clientip").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('LOCAL')
                ('WORD': 'true')
            ('WORD': 'geoip')
            ('WORD': 'clientip')

>>> splparser.parser.parse("lookup usertogroup user as local_user OUTPUT group as user_group").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('WORD': 'usertogroup')
            ('WORD': 'user')
                ('AS')
                    ('ID': 'local_user')
            ('OUTPUT')
                ('WORD': 'group')
                    ('AS')
                        ('ID': 'user_group')

>>> splparser.parser.parse("lookup update=true usertogroup user as local_user OUTPUT group as user_group").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('UPDATE')
                ('WORD': 'true')
            ('WORD': 'usertogroup')
            ('WORD': 'user')
                ('AS')
                    ('ID': 'local_user')
            ('OUTPUT')
                ('WORD': 'group')
                    ('AS')
                        ('ID': 'user_group')

>>> splparser.parser.parse("lookup swit 1 AS Snum OUTPUT Smod").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('WORD': 'swit')
            ('INT': '1')
                ('AS')
                    ('WORD': 'Snum')
            ('OUTPUT')
                ('WORD': 'Smod')

>>> splparser.parser.parse("lookup log.csv profile was_host OUTPUT cell node serverName").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('ID': 'log.csv')
            ('WORD': 'profile')
            ('ID': 'was_host')
            ('OUTPUT')
                ('WORD': 'cell')
                ('WORD': 'node')
                ('WORD': 'serverName')

>>> splparser.parser.parse("lookup Service_Account_Lookup sAMAccountName as Account_Name OUTPUT sAMAccountName AS User_Account, AdminAccount").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('ID': 'Service_Account_Lookup')
            ('WORD': 'AccountName')
                ('AS')
                    ('ID': 'Account_Name')
            ('OUTPUT')
                ('WORD': 'AccountName')
                    ('AS')
                        ('ID': 'User_account')
                        ('WORD': 'AdminAccount')

>>> splparser.parser.parse("lookup SecurityEventCode EventCode,LogName OUTPUTNEW desc").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('WORD': 'SecurityEventCode')
            ('WORD': 'EventCode')
            ('WORD': 'LogName')
            ('OUTPUTNEW')
                ('WORD': 'desc')

>>> splparser.parser.parse("lookup ip AS dst OUTPUT ip,hostname, loc1, loc2,loc3,sig").print_tree()
('ROOT')
    ('STAGE')
        ('LOOKUP')
            ('WORD': 'ip')
                ('AS')
                    ('WORD': 'dst')
            ('OUTPUT')
                ('WORD': 'ip')
                ('WORD': 'hostname')
                ('WORD': 'loc1')
                ('WORD': 'loc2')
                ('WORD': 'loc3')
                ('WORD': 'sig')

