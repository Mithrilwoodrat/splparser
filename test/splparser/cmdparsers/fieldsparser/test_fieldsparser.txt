
Below are clips from an interactive session in which I test various aspects of the parser.

>>> import splparser.parser

>>> parsed = splparser.parser.parse("fields + category action http_user_agent filter_result src_ip dest_host uri uri_path http_method http_content_type uri_query _time")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('FIELDS')
            ('PLUS')
                ('WORD': 'category')
                ('WORD': 'action')
                ('WORD': 'http_user_agent')
                ('WORD': 'filter_result')
                ('WORD': 'src_ip')
                ('WORD': 'dest_host')
                ('WORD': 'uri')
                ('WORD': 'uri_path')
                ('WORD': 'http_method')
                ('WORD': 'http_content_type')
                ('WORD': 'uri_query')
                ('WORD': '_time')

>>> parsed = splparser.parser.parse("fields IPAddress,action,HostName,user,FullFilePath,ThreatName")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('FIELDS')
            ('PLUS')
                ('WORD': 'IPAddress')
                ('WORD': 'action')
                ('WORD': 'HostName')
                ('WORD': 'user')
                ('WORD': 'FullFilePath')
                ('WORD': 'ThreatName')

>>> parsed = splparser.parser.parse("fields SSO dest_host IPaddress signature action severity cdi_city cdi_country FullFilePath")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('FIELDS')
            ('PLUS')
                ('WORD': 'SSO')
                ('WORD': 'dest_host')
                ('WORD': 'IPaddress')
                ('WORD': 'signature')
                ('WORD': 'action')
                ('WORD': 'severity')
                ('WORD': 'cdi_city')
                ('WORD': 'cdi_country')
                ('WORD': 'FullFilePath')

>>> parsed = splparser.parser.parse("fields - sum")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('FIELDS')
            ('MINUS')
                ('WORD': 'sum')

>>> parsed = splparser.parser.parse("fields - _raw,_cd,_indextime,_serial,_si,_sourcetype")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('FIELDS')
            ('MINUS')
                ('WORD': '_raw')
                ('WORD': '_cd')
                ('WORD': '_indextime')
                ('WORD': '_serial')
                ('WORD': '_si')
                ('WORD': '_sourcetype')

>>> parsed = splparser.parser.parse("fields - countHost-_span countHost-_time lag-_span")
>>> parsed.print_tree()
('ROOT')
    ('STAGE')
        ('FIELDS')
            ('MINUS')
                ('ID': 'countHost-_span')
                ('ID': 'countHost-_time')
                ('ID': 'lag-_span')
